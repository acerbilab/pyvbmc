
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Instructions for developers and contributors &#8212; PyVBMC</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://acerbilab.github.io/pyvbmc/development.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="About us" href="about_us.html" />
    <link rel="prev" title="PyVBMC Example 6: Noisy log-likelihood evaluations" href="_examples/pyvbmc_example_6_noisy_likelihoods.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quickstart.html">
   Getting started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="api/classes/vbmc.html">
   VBMC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="api/classes/variational_posterior.html">
   VariationalPosterior
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="api/options/vbmc_options.html">
   VBMC options
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="api/classes/priors.html">
   Priors
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api/advanced_docs.html">
   Advanced documentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="api/classes/acquisition_functions.html">
     Acquisition Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/classes/function_logger.html">
     FunctionLogger
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/classes/iteration_history.html">
     IterationHistory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/classes/options.html">
     Options
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/classes/parameter_transformer.html">
     ParameterTransformer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/classes/timer.html">
     Timer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/classes/variational_posterior.html">
     VariationalPosterior
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/classes/vbmc.html">
     VBMC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/functions/active_sample.html">
     active_sample
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/functions/create_vbmc_animation.html">
     create_vbmc_animation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/functions/decorators.html">
     decorators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/functions/entropy.html">
     entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/functions/get_hpd.html">
     get_hpd
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/functions/kde_1d.html">
     kde_1d
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/functions/whitening.html">
     whitening
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/options/vbmc_options.html">
     VBMC options
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="_examples/pyvbmc_example_1_basic_usage.html">
   PyVBMC Example 1: Basic usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="_examples/pyvbmc_example_2_inputs_outputs.html">
   PyVBMC Example 2: Understanding the inputs and the output trace
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="_examples/pyvbmc_example_3_diagnostics_and_saving.html">
   PyVBMC Example 3: Output diagnostics and saving results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="_examples/pyvbmc_example_4_validation.html">
   PyVBMC Example 4: Multiple runs as validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="_examples/pyvbmc_example_5_prior_distributions.html">
   PyVBMC Example 5: Prior distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="_examples/pyvbmc_example_6_noisy_likelihoods.html">
   PyVBMC Example 6: Noisy log-likelihood evaluations
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Instructions for developers and contributors
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="about_us.html">
   About us
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/acerbilab/pyvbmc"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/acerbilab/pyvbmc/issues/new?title=Issue%20on%20page%20%2Fdevelopment.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/acerbilab/pyvbmc/edit/main/development.rst"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/development.rst"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation-instructions-for-developers">
   Installation instructions for developers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#coding-conventions">
   Coding conventions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#code-formatting">
     Code formatting
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#docstrings">
     Docstrings
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#code-documentation">
     Code documentation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#general-structure">
       General structure
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exceptions">
     Exceptions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#git-commits">
     <code class="docutils literal notranslate">
      <span class="pre">
       git
      </span>
     </code>
     commits
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modules-and-code-organization">
     Modules and code organization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#testing">
     Testing
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Instructions for developers and contributors</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation-instructions-for-developers">
   Installation instructions for developers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#coding-conventions">
   Coding conventions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#code-formatting">
     Code formatting
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#docstrings">
     Docstrings
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#code-documentation">
     Code documentation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#general-structure">
       General structure
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exceptions">
     Exceptions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#git-commits">
     <code class="docutils literal notranslate">
      <span class="pre">
       git
      </span>
     </code>
     commits
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modules-and-code-organization">
     Modules and code organization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#testing">
     Testing
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="instructions-for-developers-and-contributors">
<h1>Instructions for developers and contributors<a class="headerlink" href="#instructions-for-developers-and-contributors" title="Permalink to this headline">#</a></h1>
<p>PyVBMC is the port of the MATLAB VBMC algorithm to Python 3.x (development has targeted version 3.9 and up).</p>
<p>The reference code is the <a class="reference external" href="https://github.com/acerbilab/vbmc">MATLAB toolbox</a>.</p>
<p>The documentation is available at: <a class="reference external" href="https://acerbilab.github.io/pyvbmc/">https://acerbilab.github.io/pyvbmc/</a></p>
<section id="installation-instructions-for-developers">
<h2>Installation instructions for developers<a class="headerlink" href="#installation-instructions-for-developers" title="Permalink to this headline">#</a></h2>
<p>Release versions of PyVBMC are available via <code class="docutils literal notranslate"><span class="pre">pip</span></code> (and soon, <code class="docutils literal notranslate"><span class="pre">conda-forge</span></code>), but developers will need to work with the latest source code. They should follow these steps to install:</p>
<ol class="arabic">
<li><p>(Optional, but recommended for development): Create a new environment in Conda and activate it. Requires Python 3.9 or newer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">pyvbmc</span><span class="o">-</span><span class="n">env</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.9</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">pyvbmc</span><span class="o">-</span><span class="n">env</span>
</pre></div>
</div>
</li>
<li><p>Clone the PyVBMC and GPyReg GitHub repos locally:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">acerbilab</span><span class="o">/</span><span class="n">pyvbmc</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">acerbilab</span><span class="o">/</span><span class="n">gpyreg</span>
</pre></div>
</div>
<p>(PyVBMC depends on <a class="reference external" href="https://github.com/acerbilab/gpyreg">GPyReg</a>, which is a package for lightweight Gaussian process regression in Python.)</p>
</li>
<li><p>Install the packages and their optional development dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">./</span><span class="n">gpyreg</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;.[dev]&#39;</span>
<span class="n">cd</span> <span class="o">../</span><span class="n">pyvbmc</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;.[dev]&#39;</span>
</pre></div>
</div>
</li>
<li><p>Install Jupyter to view the examples You can skip this step if you’re working from a Conda environment which already has Jupyter, but be aware that if the wrong <code class="docutils literal notranslate"><span class="pre">jupyter</span></code> executable is found on your path then import errors may arise.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="n">jupyter</span>
</pre></div>
</div>
</li>
</ol>
<p>We are using the dependencies listed in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>. Please list all used dependencies there. Dependencies are separated into basic dependencies, and optional development dependencies included under <code class="docutils literal notranslate"><span class="pre">dev</span></code>.</p>
<p>The necessary packages can be installed with <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/">conda</a> or <a class="reference external" href="https://pypi.org/project/pip/">pip</a>.</p>
</section>
<section id="coding-conventions">
<h2>Coding conventions<a class="headerlink" href="#coding-conventions" title="Permalink to this headline">#</a></h2>
<p>We try to follow common conventions whenever possible. Some useful reading:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP 8 – Style Guide for Python Code</a></p></li>
<li><p><a class="reference external" href="https://docs.python-guide.org/writing/style/">Code style in The Hitchhiker’s Guide to Python</a></p></li>
</ul>
<p>These basic rules should be followed to ensure coherence and to make it easy for third parties to contribute. In the following, we list more detailed conventions. Please read carefully if you are contributing to PyVBMC.</p>
<section id="code-formatting">
<h3>Code formatting<a class="headerlink" href="#code-formatting" title="Permalink to this headline">#</a></h3>
<p>The code is formatted using <a class="reference external" href="https://pypi.org/project/black/">Black</a> with a line length of 79, with the help of pre-commit hooks. To install and use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pre</span><span class="o">-</span><span class="n">commit</span>
<span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">install</span>
<span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">run</span> <span class="o">-</span><span class="n">a</span>  <span class="c1"># run for all files, optional</span>
</pre></div>
</div>
<p>After installation, when you try to commit the staged files, git will automatically check the files and modify them for meeting the requirements of the hooks in <code class="docutils literal notranslate"><span class="pre">.pre-commit-config.yaml</span></code>. The settings of the hooks are specified in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>. You need to restage the file if it gets modified by the hooks.</p>
<p>If you want, you can also check with Pylint for more detailed errors and warnings (although Pylint seems to raise many false positives).</p>
</section>
<section id="docstrings">
<h3>Docstrings<a class="headerlink" href="#docstrings" title="Permalink to this headline">#</a></h3>
<p>The docstrings are generated following the <a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/format.html">NumPy format</a>.
There are add-ons to generate docstring blueprints using IDE’s.</p>
<ul class="simple">
<li><p>See an example for a correct docstring from NumPy <a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/example.html">here</a>.</p></li>
<li><p>In PyVBMC, the <code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code> class can be taken as an example of (mostly) correct docstring structure, see <a class="reference external" href="https://github.com/acerbilab/pyvbmc/blob/main/variational_posterior/variational_posterior.py">here</a>.
- In particular, see how the single quotes and double quotes are used; the math notation is used; full stops are added at the end of each sentence, etc.</p></li>
</ul>
</section>
<section id="code-documentation">
<h3>Code documentation<a class="headerlink" href="#code-documentation" title="Permalink to this headline">#</a></h3>
<p>The documentation is currently hosted on <a class="reference internal" href="index.html"><span class="doc">github.io</span></a>. We build the PyVBMC documentation using <a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/quickstart.html">Sphinx</a>. The source code of the documentation is in the <a class="reference external" href="https://github.com/acerbilab/pyvbmc/blob/main/docsrc">docsrc folder</a> and the build version is in the <a class="reference external" href="https://github.com/acerbilab/pyvbmc/tree/gh-pages">gh-pages</a> branch. When the documentation is re-built, it should be pushed to the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> instead of committing it on the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.</p>
<p>To setup an existing PyVBMC repository for building documentation, please follow the steps below:</p>
<ol class="arabic">
<li><p>One-time setup:</p>
<ol class="loweralpha">
<li><p>Remove the <code class="docutils literal notranslate"><span class="pre">docs/</span></code> folder from the root of your existing PyVBMC repo, if it is present.</p></li>
<li><p>From the root of the PyVBMC repo, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="o">-</span><span class="n">b</span> <span class="n">gh</span><span class="o">-</span><span class="n">pages</span> <span class="o">--</span><span class="n">single</span><span class="o">-</span><span class="n">branch</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">acerbilab</span><span class="o">/</span><span class="n">pyvbmc</span> <span class="n">docs</span>
</pre></div>
</div>
<p>This will clone <em>only</em> the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch inside <code class="docutils literal notranslate"><span class="pre">docs/</span></code>, so that changes to the docs can now be pushed directly to <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> from within <code class="docutils literal notranslate"><span class="pre">docs/</span></code>.</p>
</li>
</ol>
</li>
<li><p>From the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch render new documentation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">docsrc</span> <span class="p">(</span><span class="n">navigate</span> <span class="n">to</span> <span class="n">documentation</span> <span class="n">source</span> <span class="n">folder</span><span class="p">)</span>
<span class="n">make</span> <span class="n">github</span>  <span class="p">(</span><span class="n">this</span> <span class="n">builds</span> <span class="n">the</span> <span class="n">doc</span> <span class="ow">and</span> <span class="n">copies</span> <span class="n">the</span> <span class="n">build</span> <span class="n">version</span> <span class="n">to</span> <span class="o">./</span><span class="n">docs</span><span class="p">)</span>
</pre></div>
</div>
<p>(If you are using Windows, run <code class="docutils literal notranslate"><span class="pre">.\make.bat</span> <span class="pre">github</span></code> with <code class="docutils literal notranslate"><span class="pre">cmd</span></code> instead.)</p>
</li>
<li><p>Change into the <code class="docutils literal notranslate"><span class="pre">docs/</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">../</span><span class="n">docs</span>
</pre></div>
</div>
</li>
<li><p>Commit the new documentation and push. <a class="reference external" href="https://acerbilab.github.io/pyvbmc/">github.io</a> will detect the changes and rebuild the website (possibly after a few minutes). Only documentation that was built from the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch should be committed to <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code>.</p></li>
</ol>
<p>If it seems that the documentation does not update correctly (e.g., items not appearing in the sidebar or table of content), try deleting the <code class="docutils literal notranslate"><span class="pre">./docs</span></code> folder and the cached folder <code class="docutils literal notranslate"><span class="pre">./docsrc/_build</span></code> before compiling the documentation. There is a command for that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">clean</span>
</pre></div>
</div>
<p>(If you are using Windows, run <code class="docutils literal notranslate"><span class="pre">.\make.bat</span> <span class="pre">clean</span></code> with <code class="docutils literal notranslate"><span class="pre">cmd</span></code> instead.)</p>
<section id="general-structure">
<h4>General structure<a class="headerlink" href="#general-structure" title="Permalink to this headline">#</a></h4>
<p>For each new class, function, etc. a <code class="docutils literal notranslate"><span class="pre">.rst</span></code> file needs to be created in an appropriate folder. The folder names are arbitrary, for now we have <code class="docutils literal notranslate"><span class="pre">functions</span></code>, <code class="docutils literal notranslate"><span class="pre">classes</span></code>, etc.
The <code class="docutils literal notranslate"><span class="pre">.rst</span></code> file contains the text in <a class="reference external" href="https://en.wikipedia.org/wiki/ReStructuredText">reStructuredText format</a>, a lightweight markup language with special commands that tell Sphynx where to compile the documentation, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">autoclass</span><span class="p">::</span> <span class="n">pyvbmc</span><span class="o">.</span><span class="n">vbmc</span><span class="o">.</span><span class="n">VBMC</span>
  <span class="p">:</span><span class="n">members</span><span class="p">:</span>
</pre></div>
</div>
<p>Refer to existing documentation for an overview of the file structure. So far the documentation includes the following:</p>
<ul class="simple">
<li><p>Status of the port (what is missing?);</p></li>
<li><p>Reference to the respective file of the original <a class="reference external" href="https://github.com/acerbilab/vbmc">MATLAB</a> implementation;</p></li>
<li><p>Known issues (if something is currently suboptimal in PyVBMC);</p></li>
<li><p>The documentation of the Python code (generated from the docstrings).</p></li>
</ul>
<p>For each new file, a link needs to be added manually to the <a class="reference external" href="https://github.com/acerbilab/pyvbmc/blob/main/docsrc/source/index.rst">index page</a>.
Please keep the documentation up to date. (Sphinx logs possible issues when compiling the documentation.)</p>
</section>
</section>
<section id="exceptions">
<h3>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">#</a></h3>
<p>Currently, the aim is to use the standard Python exceptions whenever it is sensible.
Here is a list of those <a class="reference external" href="https://docs.python.org/3/library/exceptions.html">exceptions</a>.</p>
</section>
<section id="git-commits">
<h3><code class="docutils literal notranslate"><span class="pre">git</span></code> commits<a class="headerlink" href="#git-commits" title="Permalink to this headline">#</a></h3>
<p>Commits follow the <a class="reference external" href="https://www.conventionalcommits.org/en/v1.0.0/">conventional commits</a> style. This makes it easier to collaborate on the project. A cheat sheet is can be found <a class="reference external" href="https://cheatography.com/albelop/cheat-sheets/conventional-commits/">here</a></p>
<p>Please do not submit pull requests with unfinished code or code which does not pass all tests. Work on feature branches whenever possible and sensible. All PR’s must be approved by another developer before being merged to the main branch. <a class="reference external" href="https://martinfowler.com/bliki/FeatureBranch.html">Read this</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="o">-</span><span class="n">b</span> <span class="o">&lt;</span><span class="n">new</span><span class="o">-</span><span class="n">feature</span><span class="o">&gt;</span>
<span class="p">[</span><span class="o">...</span> <span class="n">do</span> <span class="n">stuff</span> <span class="ow">and</span> <span class="n">commit</span> <span class="o">...</span><span class="p">]</span>
<span class="n">git</span> <span class="n">push</span> <span class="o">-</span><span class="n">u</span> <span class="n">origin</span> <span class="o">&lt;</span><span class="n">new</span><span class="o">-</span><span class="n">feature</span><span class="o">&gt;</span>
<span class="p">[</span><span class="o">...</span> <span class="n">when</span> <span class="n">finished</span> <span class="n">created</span> <span class="n">pull</span> <span class="n">request</span> <span class="n">on</span> <span class="n">github</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>If you switch to an existing branch using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span></code>, remember to <code class="docutils literal notranslate"><span class="pre">pull</span></code> before making any change as it is not done automatically.</p>
</section>
<section id="modules-and-code-organization">
<h3>Modules and code organization<a class="headerlink" href="#modules-and-code-organization" title="Permalink to this headline">#</a></h3>
<p>We have decided against general util/misc modules for now. This means that general-purpose functions should be included in a fitting existing module or in their own module. This approach encourages us to keep functions general and coherent to their scope. Furthermore, it improves readability for new collaborators. See some reading about that <a class="reference external" href="https://breadcrumbscollector.tech/stop-naming-your-python-modules-utils/">here</a>.</p>
</section>
<section id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">#</a></h3>
<p>The testing is done using <code class="docutils literal notranslate"><span class="pre">pytest</span></code> with unit tests for each class in the respective folder.
Tests can be run with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="n">test_filename</span><span class="o">.</span><span class="n">py</span>
<span class="n">pytest</span>
<span class="n">pytest</span> <span class="o">--</span><span class="n">reruns</span> <span class="mi">5</span> <span class="o">--</span><span class="n">cov</span><span class="o">=.</span> <span class="o">--</span><span class="n">cov</span><span class="o">-</span><span class="n">report</span> <span class="n">html</span><span class="p">:</span><span class="n">cov_html</span>
</pre></div>
</div>
<p>The final command creates an html folder with a full report on coverage – double-check it from time to time. Some tests are stochastic and occasionally fail: Tests can be automatically rerun by specifying e.g. <code class="docutils literal notranslate"><span class="pre">--reruns</span> <span class="pre">3</span></code>.</p>
<p>A few comments about testing:</p>
<ul class="simple">
<li><p>Testing is mandatory!</p></li>
<li><p>Please try to keep the total runtime of the tests minimal for the task at hand.</p></li>
<li><p>As a good practice, please rerun all tests before major commits and pull requests (might take a while, but it is worth it to avoid surprises).</p></li>
<li><p>A nice way of proceeding is ‘test first’: write a test first, make it fail, write the code until the test is passed.</p></li>
<li><p>Many methods are tested against test cases produced with the original <a class="reference external" href="https://github.com/acerbilab/vbmc">MATLAB implementation</a>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">pytest-mock</span></code> library is very useful for testing. It allows you to replace parts of your system under test with mock objects and make assertions about how they have been used. (Perhaps we should switch to <code class="docutils literal notranslate"><span class="pre">unittest.mock</span></code> in the future, which is part of the Python standard library.)</p></li>
<li><p>We should look into automating tests with GitHub actions.</p></li>
</ul>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="_examples/pyvbmc_example_6_noisy_likelihoods.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">PyVBMC Example 6: Noisy log-likelihood evaluations</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="about_us.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">About us</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
      &copy; Copyright 2022, Machine and Human Intelligence research group (PI: Luigi Acerbi, University of Helsinki).<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>