
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>VariationalPosterior &#8212; PyVBMC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/classes/variational_posterior';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://acerbilab.github.io/pyvbmc/api/classes/variational_posterior.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="VBMC options" href="../options/vbmc_options.html" />
    <link rel="prev" title="VBMC" href="vbmc.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.svg" class="logo__image only-light" alt="PyVBMC - Home"/>
    <script>document.write(`<img src="../../_static/logo.svg" class="logo__image only-dark" alt="PyVBMC - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Getting started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../_examples/pyvbmc_example_1_basic_usage.html">PyVBMC Example 1: Basic usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_examples/pyvbmc_example_2_inputs_outputs.html">PyVBMC Example 2: Understanding the inputs and the output trace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_examples/pyvbmc_example_3_diagnostics_and_saving.html">PyVBMC Example 3: Output diagnostics and saving results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_examples/pyvbmc_example_4_validation.html">PyVBMC Example 4: Multiple runs as validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_examples/pyvbmc_example_5_prior_distributions.html">PyVBMC Example 5: Prior distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_examples/pyvbmc_example_6_noisy_likelihoods.html">PyVBMC Example 6: Noisy log-likelihood evaluations</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../documentation.html">Documentation</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="vbmc.html"><code class="docutils literal notranslate"><span class="pre">VBMC</span></code></a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../options/vbmc_options.html">VBMC options</a></li>
<li class="toctree-l2"><a class="reference internal" href="priors.html">Priors</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../advanced_docs.html">Advanced documentation</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active has-children"><a class="reference internal" href="classes.html">Classes</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="acquisition_functions.html">Acquisition Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="function_logger.html"><code class="docutils literal notranslate"><span class="pre">FunctionLogger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="iteration_history.html"><code class="docutils literal notranslate"><span class="pre">IterationHistory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="options.html"><code class="docutils literal notranslate"><span class="pre">Options</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="parameter_transformer.html"><code class="docutils literal notranslate"><span class="pre">ParameterTransformer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="timer.html"><code class="docutils literal notranslate"><span class="pre">Timer</span></code></a></li>
<li class="toctree-l4 current active"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="vbmc.html"><code class="docutils literal notranslate"><span class="pre">VBMC</span></code></a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../functions/functions.html">Functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../functions/active_sample.html"><code class="docutils literal notranslate"><span class="pre">active_sample</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/create_vbmc_animation.html"><code class="docutils literal notranslate"><span class="pre">create_vbmc_animation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/decorators.html"><code class="docutils literal notranslate"><span class="pre">decorators</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/entropy.html">Entropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/get_hpd.html"><code class="docutils literal notranslate"><span class="pre">get_hpd</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/kde_1d.html"><code class="docutils literal notranslate"><span class="pre">kde_1d</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/whitening.html"><code class="docutils literal notranslate"><span class="pre">whitening</span></code></a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../options/vbmc_options.html">VBMC options</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Instructions for developers and contributors</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../about_us.html">About us</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/acerbilab/pyvbmc" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/acerbilab/pyvbmc/edit/main/docsrc/source/api/classes/variational_posterior.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/acerbilab/pyvbmc/issues/new?title=Issue%20on%20page%20%2Fapi/classes/variational_posterior.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/api/classes/variational_posterior.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>VariationalPosterior</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.variational_posterior.VariationalPosterior"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.variational_posterior.VariationalPosterior.get_bounds"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.get_bounds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.variational_posterior.VariationalPosterior.get_parameters"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.get_parameters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.variational_posterior.VariationalPosterior.mode"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.mode()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.variational_posterior.VariationalPosterior.set_parameters"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.set_parameters()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.kl_div"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.kl_div()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.log_pdf"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.log_pdf()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.load"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.load()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.moments"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.moments()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.mtv"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.mtv()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.pdf"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.pdf()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.plot"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.plot()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.sample"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.sample()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.save"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.save()</span></code></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="variationalposterior">
<h1><code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code><a class="headerlink" href="#variationalposterior" title="Link to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The main output of a PyVBMC run is a <code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code> object <code class="docutils literal notranslate"><span class="pre">vp</span></code>.</p>
<p>The variational posterior can be queried and manipulated via several methods, such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">moments</span></code>: compute mean and covariance matrix of the variational posterior;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pdf</span></code>: evaluate the variational posterior density at a point;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot</span></code>: plot the variational posterior as a corner plot (1D and 2D marginals);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>: draw random samples from the variational posterior.</p></li>
</ul>
<p>There are also methods to compare variational posteriors:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">kl_div</span></code>: compute the Kullback-Leibler divergence between two posteriors;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mtv</span></code>: compute the marginal total variation distance between two posteriors.</p></li>
</ul>
<p>See below for the full <code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code> class methods and interface.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvbmc.variational_posterior.</span></span><span class="sig-name descname"><span class="pre">VariationalPosterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameter_transformer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyvbmc/variational_posterior/variational_posterior.html#VariationalPosterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior" title="Link to this definition">#</a></dt>
<dd><p>The variational posterior class used in PyVBMC.</p>
<p>The variational posterior represents the approximate posterior as returned
by the Variational Bayesian Monte Carlo (VBMC) algorithm.</p>
<p>In VBMC, the variational posterior is a weighted mixture of multivariate
normal distributions (see Notes below for details).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>D</strong><span class="classifier">int</span></dt><dd><p>The number of dimensions (i.e., parameters) of the posterior.</p>
</dd>
<dt><strong>K</strong><span class="classifier">int, optional</span></dt><dd><p>The number of mixture components, default 2.</p>
</dd>
<dt><strong>x0</strong><span class="classifier">np.ndarray, optional</span></dt><dd><p>The starting vector for the mixture components means. It can be a
single array or multiple rows (up to <cite>K</cite>); missing rows are
duplicated by making copies of <cite>x0</cite>, default <code class="docutils literal notranslate"><span class="pre">np.zeros</span></code>.</p>
</dd>
<dt><strong>parameter_transformer</strong><span class="classifier">ParameterTransformer, optional</span></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">ParameterTransformer</span></code> object specifying the transformation of
the input space that leads to the current representation used by the
variational posterior, by default uses an identity transform.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In VBMC, the variational posterior is defined as a mixture of multivariate
normal distributions as follows:</p>
<div class="math notranslate nohighlight">
\[q({\theta}) = \sum_{k = 1}^K w_k N(\theta, \mu_k, \sigma^2_k \Lambda)\]</div>
<p>where <span class="math notranslate nohighlight">\(w_k\)</span> are the mixture weights, <span class="math notranslate nohighlight">\(\mu_k\)</span> the component means,
<span class="math notranslate nohighlight">\(\sigma_k\)</span> scaling factors, and <span class="math notranslate nohighlight">\(\Lambda\)</span> is a diagonal matrix
common to all components with elements <span class="math notranslate nohighlight">\(\lambda^2_d\)</span> on the diagonal,
for <span class="math notranslate nohighlight">\(1 \le d \le D\)</span>.</p>
<p>Note that <span class="math notranslate nohighlight">\(q({\theta})\)</span> is defined in an unconstrained space.
Constrained variables in the posterior are mapped to a trasformed,
unconstrained space via a nonlinear mapping (represented by a
<code class="docutils literal notranslate"><span class="pre">ParameterTransformer</span></code> object). The transformation is handled
automatically.</p>
<p>In practice, you would almost never create a new <code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code>
object, simply use the variational posteriors returned by <code class="docutils literal notranslate"><span class="pre">VBMC</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">np.ndarray</span></dt><dd><p>The weights of the VP mixture components, shape <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">K)</span></code>.</p>
</dd>
<dt><strong>eta</strong><span class="classifier">np.ndarray</span></dt><dd><p>The unbounded (softmax) parametrization of the VP mixture components,
shape <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">K)</span></code>.</p>
</dd>
<dt><strong>mu</strong><span class="classifier">np.ndarray</span></dt><dd><p>The means of the VP mixture components, shape <code class="docutils literal notranslate"><span class="pre">(D,</span> <span class="pre">K)</span></code>.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">np.ndarray</span></dt><dd><p>The per-component scale of the VP mixture components. Shape <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">K)</span></code>.</p>
</dd>
<dt><strong>lambd</strong><span class="classifier">np.ndarray</span></dt><dd><p>The per-dimension scale of the VP mixture components. Shape <code class="docutils literal notranslate"><span class="pre">(D,</span> <span class="pre">1)</span></code>.</p>
</dd>
<dt><strong>optimize_weights</strong><span class="classifier">bool</span></dt><dd><p>Whether to optimize the weights.</p>
</dd>
<dt><strong>optimize_mu</strong><span class="classifier">bool</span></dt><dd><p>Whether to optimize the means.</p>
</dd>
<dt><strong>optimize_sigma</strong><span class="classifier">bool</span></dt><dd><p>Whether to optimize <code class="docutils literal notranslate"><span class="pre">sigma</span></code>.</p>
</dd>
<dt><strong>optimize_lambd</strong><span class="classifier">bool</span></dt><dd><p>Whether to optimize <code class="docutils literal notranslate"><span class="pre">lambd</span></code>.</p>
</dd>
<dt><strong>parameter_transformer</strong><span class="classifier">ParameterTransformer</span></dt><dd><p>The parameter transformer implementing transformations to/from
unbounded space.</p>
</dd>
<dt><strong>bounds</strong><span class="classifier">dict</span></dt><dd><p>A dictionary containing the soft bounds for each variable to be
optimized.</p>
</dd>
<dt><strong>stats</strong><span class="classifier">dict</span></dt><dd><p>A dictionary of statistics and other relevant info computed during
optimization.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyvbmc.VariationalPosterior.VariationalPosterior.kl_div">
<span class="sig-name descname"><span class="pre">kl_div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyvbmc.variational_posterior.VariationalPosterior" title="pyvbmc.variational_posterior.variational_posterior.VariationalPosterior"><span class="pre">VariationalPosterior</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gauss_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvbmc.VariationalPosterior.VariationalPosterior.kl_div" title="Link to this definition">#</a></dt>
<dd><p>Kullback-Leibler divergence between two variational posteriors.</p>
<p>Compute the forward and reverse Kullback-Leibler (KL) divergence between
two posteriors. The other variational posterior can be specified as
<cite>vp2</cite> (an instance of the class <code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code>) or with
<cite>samples</cite>. One of the two must be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>vp2</strong><span class="classifier">VariationalPosterior, optional</span></dt><dd><p>The other <code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code>, by default None.</p>
</dd>
<dt><strong>samples</strong><span class="classifier">np.ndarray, optional</span></dt><dd><p>An <cite>N</cite>-by-<cite>D</cite> matrix of samples from the other variational
posterior, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><strong>N</strong><span class="classifier">int, optional</span></dt><dd><p>The number of random samples to estimate the KL divergence,
by default <code class="docutils literal notranslate"><span class="pre">int(1e5)</span></code>.</p>
</dd>
<dt><strong>gauss_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, returns a “Gaussianized” KL-divergence, that is the KL
divergence between two multivariate normal distributions with the
same moments as the variational posteriors given as inputs.
By default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>kl_div: np.ndarray</dt><dd><p>A two-element vector containing the forward and reverse
Kullback-Leibler divergence between the two posteriors.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>Raised if neither <cite>vp2</cite> nor <cite>samples</cite> are specified.</p>
</dd>
<dt>ValueError</dt><dd><p>Raised if <cite>vp2</cite> is not provided but <cite>gauss_flag</cite> = <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Since the KL divergence is not symmetric, the method returns both the
forward and the reverse KL divergence, that is KL(<cite>vp1</cite> || <cite>vp2</cite>) and
KL(<cite>vp2</cite> || <cite>vp1</cite>).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyvbmc.VariationalPosterior.VariationalPosterior.log_pdf">
<span class="sig-name descname"><span class="pre">log_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvbmc.VariationalPosterior.VariationalPosterior.log_pdf" title="Link to this definition">#</a></dt>
<dd><p>log-probability density function of the variational posterior.</p>
<p>Compute the log density of the variational posterior at one or multiple
input points. The parameters are the same as for <code class="docutils literal notranslate"><span class="pre">vp.pdf()</span></code> with
<code class="docutils literal notranslate"><span class="pre">log_flag=True</span></code>. These parameters are described again here for
reference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">np.ndarray</span></dt><dd><p><cite>x</cite> is a matrix of inputs to evaluate the pdf at.
The rows of the <cite>N</cite>-by-<cite>D</cite> matrix <cite>x</cite> correspond to observations or
points, and columns correspond to variables or coordinates. <cite>x</cite> is
assumed to be in the original space by default.</p>
</dd>
<dt><strong>orig_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>Controls if the value of the posterior density should be evaluated
in the original parameter space for <cite>orig_flag</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, or in
the transformed space if <cite>orig_flag</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, by default
<code class="docutils literal notranslate"><span class="pre">True</span></code>. Accordingly, <cite>x</cite> should be in the original space if
<cite>orig_flag</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> and be in the transformed space if
<cite>orig_flag</cite> is <cite>False</cite>.</p>
</dd>
<dt><strong>grad_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> the gradient of the log-pdf is returned as a second
output, by default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>df</strong><span class="classifier">float, optional</span></dt><dd><p>Compute the log-pdf of a heavy-tailed version of the variational
posterior, in which the multivariate normal components have been
replaced by multivariate <cite>t</cite>-distributions with <cite>df</cite> degrees of
freedom. The default is <cite>df</cite> = <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>, limit in which the
<cite>t</cite>-distribution becomes a multivariate normal.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>log_pdf: np.ndarray</dt><dd><p>The probability density of the variational posterior
evaluated at each row of <cite>x</cite>.</p>
</dd>
<dt>gradient: np.ndarray</dt><dd><p>If <cite>grad_flag</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the function returns the gradient as well.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd><p>Raised if <cite>df</cite> is non-zero and finite and <cite>grad_flag</cite> = <code class="docutils literal notranslate"><span class="pre">True</span></code>
(Gradient of heavy-tailed pdf not supported yet).</p>
</dd>
<dt>NotImplementedError</dt><dd><p>Raised if <cite>orig_flag</cite> = <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>grad_flag</cite> = <code class="docutils literal notranslate"><span class="pre">True</span></code>
(gradient computation in original space not supported yet).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyvbmc.VariationalPosterior.VariationalPosterior.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvbmc.VariationalPosterior.VariationalPosterior.load" title="Link to this definition">#</a></dt>
<dd><p>Load a VP from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file</strong><span class="classifier">path-like</span></dt><dd><p>The file name or path to write to.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>vp</strong><span class="classifier">VariationalPosterior</span></dt><dd><p>The loaded VP instance.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>OSError</dt><dd><p>If the file cannot be found, or cannot be opened for other reasons.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyvbmc.VariationalPosterior.VariationalPosterior.moments">
<span class="sig-name descname"><span class="pre">moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvbmc.VariationalPosterior.VariationalPosterior.moments" title="Link to this definition">#</a></dt>
<dd><p>Compute mean and covariance matrix of variational posterior.</p>
<p>In the original space, the moments are estimated via Monte Carlo
sampling. If requested in the transformed (unconstrained) space used
internally by VBMC, the moments can be computed analytically.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>N</strong><span class="classifier">int, optional</span></dt><dd><p>Number of samples used to estimate the moments, by default <code class="docutils literal notranslate"><span class="pre">int(1e6)</span></code>.</p>
</dd>
<dt><strong>orig_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, compute moments in the original parameter space,
otherwise in the transformed VBMC space. By default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt><strong>cov_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, return the covariance matrix as a second return value,
by default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>mean: np.ndarray</dt><dd><p>The mean of the variational posterior.</p>
</dd>
<dt>cov: np.ndarray</dt><dd><p>If <cite>cov_flag</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, returns the covariance matrix as well.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyvbmc.VariationalPosterior.VariationalPosterior.mtv">
<span class="sig-name descname"><span class="pre">mtv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pyvbmc.variational_posterior.VariationalPosterior" title="pyvbmc.variational_posterior.variational_posterior.VariationalPosterior"><span class="pre">VariationalPosterior</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvbmc.VariationalPosterior.VariationalPosterior.mtv" title="Link to this definition">#</a></dt>
<dd><p>Marginal total variation distances between two variational posteriors.</p>
<p>Compute the total variation distance between the variational
posterior and a second posterior, separately for each dimension (hence
“marginal” total variation distance, MTV). The second posterior can be
specified either as a <code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code> or as a set of samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>vp2</strong><span class="classifier">VariationalPosterior, optional</span></dt><dd><p>The other <code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code>, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><strong>samples</strong><span class="classifier">np.ndarray, optional</span></dt><dd><p>An <cite>N</cite>-by-<cite>D</cite> matrix of samples from the other variational
posterior, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><strong>N</strong><span class="classifier">int, optional</span></dt><dd><p>The number of random draws to estimate the MTV, by default <code class="docutils literal notranslate"><span class="pre">int(1e5)</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>mtv: np.ndarray</dt><dd><p>A <cite>D</cite>-element vector whose elements are the total variation distance
between the marginal distributions of <cite>vp</cite> and <cite>vp1</cite> or <cite>samples</cite>,
for each coordinate dimension.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>Raised if neither <cite>vp2</cite> nor <cite>samples</cite> are specified.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The total variation distance between two densities <span class="math notranslate nohighlight">\(p_1\)</span> and <span class="math notranslate nohighlight">\(p_2\)</span> is:</p>
<div class="math notranslate nohighlight">
\[TV(p_1, p_2) = \frac{1}{2} \int | p_1(x) - p_2(x) | dx.\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyvbmc.VariationalPosterior.VariationalPosterior.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvbmc.VariationalPosterior.VariationalPosterior.pdf" title="Link to this definition">#</a></dt>
<dd><p>Probability density function of the variational posterior.</p>
<p>Compute the probability density function (pdf) of the variational
posterior at one or multiple input points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">np.ndarray</span></dt><dd><p><cite>x</cite> is a matrix of inputs to evaluate the pdf at.
The rows of the <cite>N</cite>-by-<cite>D</cite> matrix <cite>x</cite> correspond to observations or
points, and columns correspond to variables or coordinates. <cite>x</cite> is
assumed to be in the original space by default.</p>
</dd>
<dt><strong>orig_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>Controls if the value of the posterior density should be evaluated
in the original parameter space for <cite>orig_flag</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, or in
the transformed space if <cite>orig_flag</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, by default
<code class="docutils literal notranslate"><span class="pre">True</span></code>. Accordingly, <cite>x</cite> should be in the original space if
<cite>orig_flag</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> and be in the transformed space if
<cite>orig_flag</cite> is <cite>False</cite>.</p>
</dd>
<dt><strong>log_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>log_flag</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> return the logarithm of the pdf,
by default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>grad_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> the gradient of the pdf is returned as a second output,
by default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>df</strong><span class="classifier">float, optional</span></dt><dd><p>Compute the pdf of a heavy-tailed version of the variational
posterior, in which the multivariate normal components
have been replaced by multivariate <cite>t</cite>-distributions with
<cite>df</cite> degrees of freedom. The default is <cite>df</cite> = <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>, limit in
which the <cite>t</cite>-distribution becomes a multivariate normal.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pdf: np.ndarray</dt><dd><p>The probability density of the variational posterior
evaluated at each row of <cite>x</cite>.</p>
</dd>
<dt>gradient: np.ndarray</dt><dd><p>If <cite>grad_flag</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the function returns the gradient as well.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd><p>Raised if <cite>df</cite> is non-zero and finite and <cite>grad_flag</cite> = <code class="docutils literal notranslate"><span class="pre">True</span></code>
(Gradient of heavy-tailed pdf not supported yet).</p>
</dd>
<dt>NotImplementedError</dt><dd><p>Raised if <cite>orig_flag</cite> = <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>log_flag</cite> = <code class="docutils literal notranslate"><span class="pre">True</span></code> and
<cite>grad_flag</cite> = <code class="docutils literal notranslate"><span class="pre">True</span></code> (gradient computation of the log-pdf in the
original space is not supported yet).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyvbmc.VariationalPosterior.VariationalPosterior.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_vp_centres</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_style</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GaussianProcess</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvbmc.VariationalPosterior.VariationalPosterior.plot" title="Link to this definition">#</a></dt>
<dd><p>Plot the variational posterior.</p>
<p><cite>plot</cite> displays the variational posterior as a cornerplot showing the
1D and 2D marginals, estimated from samples. It uses the  <a class="reference external" href="https://corner.readthedocs.io/en/latest/index.html">corner</a> package.</p>
<p><cite>plot</cite> also optionally displays the centres of the variational mixture
components and the datapoints of the underlying Gaussian process (GP)
used by <code class="docutils literal notranslate"><span class="pre">VBMC</span></code>. The plot can be enhanced by custom styles and specific
datapoints of the GP can be highlighted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n_samples</strong><span class="classifier">int, optional</span></dt><dd><p>The number of posterior samples used to create the plot, by default
<code class="docutils literal notranslate"><span class="pre">int(1e5)</span></code>.</p>
</dd>
<dt><strong>title</strong><span class="classifier">str, optional</span></dt><dd><p>The title of the plot, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><strong>plot_data</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to plot the datapoints of the GP, by default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>highlight_data</strong><span class="classifier">list, optional</span></dt><dd><p>Indices of the GP datapoints that should be plotted in a different
way than the other datapoints, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><strong>plot_vp_centres</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to plot the centres of the <cite>vp</cite> components, by default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>plot_style</strong><span class="classifier">dict, optional</span></dt><dd><dl class="simple">
<dt>A dictionary of plot styling options. The possible options are:</dt><dd><dl class="simple">
<dt><strong>corner</strong><span class="classifier">dict, optional</span></dt><dd><p>Styling options directly passed to the corner function.
By default: <code class="docutils literal notranslate"><span class="pre">{&quot;fig&quot;:</span> <span class="pre">plt.figure(figsize=(8,</span> <span class="pre">8)),</span>
<span class="pre">&quot;labels&quot;:</span> <span class="pre">labels}</span></code>. See the documentation of <a class="reference external" href="https://corner.readthedocs.io/en/latest/index.html">corner</a>.</p>
</dd>
<dt><strong>data</strong><span class="classifier">dict, optional</span></dt><dd><p>Styling options used to plot the GP data.
By default: <code class="docutils literal notranslate"><span class="pre">{&quot;s&quot;:15,</span> <span class="pre">&quot;color&quot;:'blue',</span> <span class="pre">&quot;facecolors&quot;:</span> <span class="pre">&quot;none&quot;}</span></code>.</p>
</dd>
<dt><strong>highlight_data</strong><span class="classifier">dict, optional</span></dt><dd><p>Styling options used to plot the highlighted GP data.
By default: <code class="docutils literal notranslate"><span class="pre">{&quot;s&quot;:15,</span> <span class="pre">&quot;color&quot;:&quot;orange&quot;}</span></code>.</p>
</dd>
<dt><strong>vp_centre</strong><span class="classifier">dict, optional</span></dt><dd><p>Styling options used to plot the <cite>vp</cite> centres.
By default: <code class="docutils literal notranslate"><span class="pre">{&quot;marker&quot;:&quot;x&quot;,</span> <span class="pre">&quot;color&quot;:&quot;red&quot;}</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt><strong>gp</strong><span class="classifier">gpyreg.GaussianProcess, optional</span></dt><dd><p>The GP to use for plotting actively sampled points.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fig</strong><span class="classifier">matplotlib.figure.Figure</span></dt><dd><p>The resulting <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> figure of the plot.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyvbmc.VariationalPosterior.VariationalPosterior.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">balance_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvbmc.VariationalPosterior.VariationalPosterior.sample" title="Link to this definition">#</a></dt>
<dd><p>Draw random samples from the variational posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>N</strong><span class="classifier">int</span></dt><dd><p>Number of samples to draw.</p>
</dd>
<dt><strong>orig_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>orig_flag</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the random vectors are returned
in the original parameter space. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, they are returned in
the transformed, unconstrained space used internally by VBMC.
By default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt><strong>balance_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>balance_flag</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the generating process is balanced
such that the random samples come from each mixture component
exactly proportionally (or as close as possible) to the variational
mixture weights. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the generating mixture component for
each sample is determined randomly, according to the mixture weights.
By default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>df</strong><span class="classifier">float, optional</span></dt><dd><p>Generate the samples from a heavy-tailed version of the variational
posterior, in which the multivariate normal components have been
replaced by multivariate <cite>t</cite>-distributions with <cite>df</cite> degrees of
freedom. The default is <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>, limit in which the
<cite>t</cite>-distribution becomes a multivariate normal.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>X</strong><span class="classifier">np.ndarray</span></dt><dd><p><cite>X</cite> is an <cite>N</cite>-by-<cite>D</cite> matrix of random vectors drawn from the
variational posterior.</p>
</dd>
<dt><strong>I</strong><span class="classifier">np.ndarray</span></dt><dd><p><cite>I</cite> is an <cite>N</cite>-by-1 array such that the <cite>i</cite>-th element of <cite>I</cite>
indicates the index of the variational mixture component from which
the <cite>i</cite>-th row of X has been generated.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyvbmc.VariationalPosterior.VariationalPosterior.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvbmc.VariationalPosterior.VariationalPosterior.save" title="Link to this definition">#</a></dt>
<dd><p>Save the VP to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file</strong><span class="classifier">path-like</span></dt><dd><p>The file name or path to write to. Default file extension <cite>.pkl</cite>
will be added if no extension is specified.</p>
</dd>
<dt><strong>overwrite</strong><span class="classifier">bool</span></dt><dd><p>Whether to allow overwriting existing files. Default <cite>False</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>FileExistsError</dt><dd><p>If the file already exists and <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is <cite>False</cite>.</p>
</dd>
<dt>OSError</dt><dd><p>If the file cannot be opened for other reasons (e.g., the directory
is not found, the disk is full, etc.).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.get_bounds">
<span class="sig-name descname"><span class="pre">get_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyvbmc/variational_posterior/variational_posterior.html#VariationalPosterior.get_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.get_bounds" title="Link to this definition">#</a></dt>
<dd><p>Compute soft bounds for variational posterior parameters.</p>
<p>These bounds are used during the variational optimization in <code class="docutils literal notranslate"><span class="pre">VBMC</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">ndarray, shape (N, D)</span></dt><dd><p>Training inputs.</p>
</dd>
<dt><strong>options</strong><span class="classifier">Options</span></dt><dd><p>Program options.</p>
</dd>
<dt><strong>K</strong><span class="classifier">int, optional</span></dt><dd><p>The number of mixture components. By default we use the
number provided at class instantiation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>theta_bnd</strong><span class="classifier">dict</span></dt><dd><dl class="simple">
<dt>A dictionary of soft bounds with the following elements:</dt><dd><dl class="simple">
<dt><strong>lb</strong><span class="classifier">np.ndarray</span></dt><dd><p>Lower bounds.</p>
</dd>
<dt><strong>ub</strong><span class="classifier">np.ndarray</span></dt><dd><p>Upper bounds.</p>
</dd>
<dt><strong>tol_con</strong><span class="classifier">float</span></dt><dd><p>Fractional tolerance for constraint violation of
variational parameters.</p>
</dd>
<dt><strong>weight_threshold</strong><span class="classifier">float, optional</span></dt><dd><p>Threshold below which weights are penalized.</p>
</dd>
<dt><strong>weight_penalty</strong><span class="classifier">float, optional</span></dt><dd><p>The penalty for weight below the threshold.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.get_parameters">
<span class="sig-name descname"><span class="pre">get_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyvbmc/variational_posterior/variational_posterior.html#VariationalPosterior.get_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.get_parameters" title="Link to this definition">#</a></dt>
<dd><p>Get variational posterior parameters as single array.</p>
<p>Return all the active <code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code> parameters
flattened as a 1D (numpy) array, possibly transformed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>raw_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>Specifies whether the sigma and lambda parameters are
returned as raw (unconstrained) or not, by default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>theta</strong><span class="classifier">np.ndarray</span></dt><dd><p>The variational posterior parameters flattenend as a 1D array.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.mode">
<span class="sig-name descname"><span class="pre">mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orig_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_opts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyvbmc/variational_posterior/variational_posterior.html#VariationalPosterior.mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.mode" title="Link to this definition">#</a></dt>
<dd><p>Find the mode of the variational posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>orig_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> find the mode of the variational posterior in the
original parameter space, otherwise in the transformed parameter
space. By default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt><strong>n_opts</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum number of optimization runs from different starting points
to find the mode. By default <cite>n_opts</cite> is the square root of the
number of mixture components K, that is
<span class="math notranslate nohighlight">\(n\_opts = \lceil \sqrt{K} \rceil\)</span>.</p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>——-</strong></dt><dd></dd>
<dt><strong>mode: np.ndarray</strong></dt><dd><p>The mode of the variational posterior.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Mode estimation (e.g., for the purpose of maximum-a-posteriori
estimation) is not recommended with VBMC, since due to the underlying
representation (mixture of Gaussians) the mode of the variational
posterior is a brittle and potentially unreliable estimator of the
mode of the target posterior, especially if it lies close to the
boundaries of the space.</p>
<p>The mode is not invariant to nonlinear reparameterizations of
the input space, so the mode in the original space and the mode in the
transformed (unconstrained) space will generally be in different
locations (even after applying the appropriate transformations).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.set_parameters">
<span class="sig-name descname"><span class="pre">set_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyvbmc/variational_posterior/variational_posterior.html#VariationalPosterior.set_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.set_parameters" title="Link to this definition">#</a></dt>
<dd><p>Set variational posterior parameters from a single array.</p>
<p>Takes as input a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array and assigns it to the
variational posterior parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>theta</strong><span class="classifier">np.ndarray</span></dt><dd><p>The array with the parameters that should be assigned.</p>
</dd>
<dt><strong>raw_flag</strong><span class="classifier">bool, optional</span></dt><dd><p>Specifies whether the sigma and lambda parameters are
passed as raw (unconstrained) or not, by default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ValueError</dt><dd><p>Raised if sigma, lambda and weights are not positive
and raw_flag = <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="vbmc.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><code class="docutils literal notranslate"><span class="pre">VBMC</span></code></p>
      </div>
    </a>
    <a class="right-next"
       href="../options/vbmc_options.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">VBMC options</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.variational_posterior.VariationalPosterior"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.variational_posterior.VariationalPosterior.get_bounds"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.get_bounds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.variational_posterior.VariationalPosterior.get_parameters"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.get_parameters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.variational_posterior.VariationalPosterior.mode"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.mode()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.variational_posterior.VariationalPosterior.set_parameters"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.set_parameters()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.kl_div"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.kl_div()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.log_pdf"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.log_pdf()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.load"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.load()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.moments"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.moments()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.mtv"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.mtv()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.pdf"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.pdf()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.plot"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.plot()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.sample"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.sample()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyvbmc.VariationalPosterior.VariationalPosterior.save"><code class="docutils literal notranslate"><span class="pre">VariationalPosterior.save()</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022, Machine and Human Intelligence research group (PI: Luigi Acerbi, University of Helsinki).
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>