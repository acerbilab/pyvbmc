
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VariationalPosterior &#8212; PyVBMC</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="VBMC" href="vbmc.html" />
    <link rel="prev" title="Getting started" href="../../quickstart.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">PyVBMC</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../quickstart.html">
   Getting started
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   VariationalPosterior
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vbmc.html">
   VBMC
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../advanced_docs.html">
   Advanced documentation
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="acquisition_functions.html">
     Acquisition Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="function_logger.html">
     FunctionLogger
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="options.html">
     Options
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_transformer.html">
     ParameterTransformer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="iteration_history.html">
     IterationHistory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="timer.html">
     Timer
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     VariationalPosterior
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="vbmc.html">
     VBMC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../functions/active_sample.html">
     active_sample
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../functions/create_vbmc_animation.html">
     create_vbmc_animation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../functions/decorators.html">
     decorators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../functions/get_hpd.html">
     get_hpd
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../functions/kde1d.html">
     kde1d
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../functions/entropy.html">
     entropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../options/vbmc_options.html">
     VBMC options
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../_examples/pyvbmc_example_1.html">
   Example 1: Basic usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../_examples/pyvbmc_example_2.html">
   Example 2: Understanding the inputs and the output trace
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about_us.html">
   About us
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/api/classes/variational_posterior.rst"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="variationalposterior">
<h1>VariationalPosterior<a class="headerlink" href="#variationalposterior" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The main output of a <code class="docutils literal notranslate"><span class="pre">pyvbmc</span></code> run is a <code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code> object <code class="docutils literal notranslate"><span class="pre">vp</span></code>.</p>
<p>The variational posterior can be queried and manipulated via several methods, such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">moments</span></code>: compute mean and covariance matrix of the variational posterior;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pdf</span></code>: evaluate the variational posterior density at a point;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot</span></code>: plot the variational posterior as a corner plot (1D and 2D marginals);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>: draw random samples from the variational posterior.</p></li>
</ul>
<p>There are also methods to compare variational posteriors:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">kldiv</span></code>: compute the Kullback-Leibler divergence between two posteriors;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mtv</span></code>: compute the marginal total variation distance between two posteriors.</p></li>
</ul>
<p>See below for the full <code class="docutils literal notranslate"><span class="pre">VariationalPosterior</span></code> class methods and interface.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyvbmc.variational_posterior.</span></span><span class="sig-name descname"><span class="pre">VariationalPosterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameter_transformer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/lacerbi/pyvbmc/tree/main/pyvbmc\variational_posterior\variational_posterior.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior" title="Permalink to this definition">¶</a></dt>
<dd><p>The Variational Posterior class used in the context of VBMC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>D</strong><span class="classifier">int</span></dt><dd><p>The number of dimensions of the Variational Posterior.</p>
</dd>
<dt><strong>K</strong><span class="classifier">int, optional</span></dt><dd><p>The number of mixture components, default 2.</p>
</dd>
<dt><strong>x0</strong><span class="classifier">np.ndarray, optional</span></dt><dd><p>The starting vector for the mixture components means, it can be a
single array or multiple rows (up to K); missing rows are
duplicated by making copies of x0, default np.zeros.</p>
</dd>
<dt><strong>parameter_transformer</strong><span class="classifier">ParameterTransformer, optional</span></dt><dd><p>The ParameterTransformer object specifying the transformation of the
input space that leads to the current representation used by the
variational posterior, by default uses an identity transform.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.get_bounds">
<span class="sig-name descname"><span class="pre">get_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/lacerbi/pyvbmc/tree/main/pyvbmc\variational_posterior\variational_posterior.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.get_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute soft bounds for variational posterior parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">ndarray, shape (N, D)</span></dt><dd><p>Training inputs.</p>
</dd>
<dt><strong>options</strong><span class="classifier">Options</span></dt><dd><p>Program options.</p>
</dd>
<dt><strong>K</strong><span class="classifier">int, optional</span></dt><dd><p>The number of mixture components. By default we use the
number provided at class instantiation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>theta_bnd</strong><span class="classifier">dict</span></dt><dd><dl class="simple">
<dt>A dictionary of soft bounds with the following elements:</dt><dd><dl class="simple">
<dt><strong>lb</strong><span class="classifier">np.ndarray</span></dt><dd><p>Lower bounds.</p>
</dd>
<dt><strong>ub</strong><span class="classifier">np.ndarray</span></dt><dd><p>Upper bounds.</p>
</dd>
<dt><strong>tol_con</strong><span class="classifier">float</span></dt><dd><p>Fractional tolerance for constraint violation of
variational parameters.</p>
</dd>
<dt><strong>weight_threshold</strong><span class="classifier">float, optional</span></dt><dd><p>Threshold below which weights are penalized.</p>
</dd>
<dt><strong>weight_penalty</strong><span class="classifier">float, optional</span></dt><dd><p>The penalty for weight below the threshold.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.get_parameters">
<span class="sig-name descname"><span class="pre">get_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rawflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/lacerbi/pyvbmc/tree/main/pyvbmc\variational_posterior\variational_posterior.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.get_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all the active VariationalPosterior parameters
flattened as a 1D (numpy) array and properly transformed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>rawflag</strong><span class="classifier">bool, optional</span></dt><dd><p>Specifies whether the sigma and lambda are
returned as raw (unconstrained) or not, by default True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>theta</strong><span class="classifier">np.ndarray</span></dt><dd><p>The VP parameters flattenend as an 1D array.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.kldiv">
<span class="sig-name descname"><span class="pre">kldiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyvbmc.variational_posterior.VariationalPosterior" title="pyvbmc.variational_posterior.variational_posterior.VariationalPosterior"><span class="pre">pyvbmc.variational_posterior.variational_posterior.VariationalPosterior</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussflag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/lacerbi/pyvbmc/tree/main/pyvbmc\variational_posterior\variational_posterior.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.kldiv" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Kullback-Leibler divergence between two variational
posteriors.</p>
<p>The other variational posterior can be specified as <cite>vp2</cite> (an instance
of the class VariationalPosterior) or using with <cite>samples</cite> from the
other VariationalPosterior. One of the two must be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>vp2</strong><span class="classifier">VariationalPosterior, optional</span></dt><dd><p>The other VariationalPosterior, by default None.</p>
</dd>
<dt><strong>samples</strong><span class="classifier">np.ndarray, optional</span></dt><dd><p>An N-by-D matrix of samples from the other variational
posterior, by default None.</p>
</dd>
<dt><strong>N</strong><span class="classifier">int, optional</span></dt><dd><p>The number of random draws to estimate the kldiv,
by default int(1e5).</p>
</dd>
<dt><strong>gaussflag</strong><span class="classifier">bool, optional</span></dt><dd><p>Returns a “Gaussianized” KL-divergence if gaussflag=True,
that is the KL divergence between two
multivariate normal distibutions with the same moments
as the variational posteriors given as inputs, by default False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>kldiv: np.ndarray</dt><dd><p>The Kullback-Leibler divergence between the two VPs.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>Raised if neither vp2 nor samples are specified.</p>
</dd>
<dt>ValueError</dt><dd><p>Raised if vp2 is not provided but gaussflag=true.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.mode">
<span class="sig-name descname"><span class="pre">mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/lacerbi/pyvbmc/tree/main/pyvbmc\variational_posterior\variational_posterior.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the mode of Variational Posterior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nmax</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum number of optimization runs to find the mode.
If nmax &lt; self.K the starting points for the optimization are chosen
as the centers of the components with the highest values of the pdf
at those points, by default 20.</p>
</dd>
<dt><strong>origflag</strong><span class="classifier">bool, optional</span></dt><dd><p>if origflag=True (default) find the  mode of the
variational posterior in the original parameter space or if
origflag=False in the transformed parameter space, by default True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>mode: np.ndarray</dt><dd><p>The mode of the variational posterior.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.moments">
<span class="sig-name descname"><span class="pre">moments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/lacerbi/pyvbmc/tree/main/pyvbmc\variational_posterior\variational_posterior.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mean MU and covariance matrix SIGMA
of the variational posterior via Monte Carlo sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>N</strong><span class="classifier">int, optional</span></dt><dd><p>The number of samples to compute moments from, by default int(1e6).</p>
</dd>
<dt><strong>origflag</strong><span class="classifier">bool, optional</span></dt><dd><p>if origflag=True (default) sample in the original parameter space or
if origflag=False sample in the transformed VBMC space,
by default True.</p>
</dd>
<dt><strong>covflag</strong><span class="classifier">bool, optional</span></dt><dd><p>If covflag=True returns covariance as second return value,
by default False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>mean: np.ndarray</dt><dd><p>The mean of the variational posterior.</p>
</dd>
<dt>cov: np.ndarray</dt><dd><p>If covflag=True returns covariance as second return value.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.mtv">
<span class="sig-name descname"><span class="pre">mtv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vp2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyvbmc.variational_posterior.VariationalPosterior" title="pyvbmc.variational_posterior.variational_posterior.VariationalPosterior"><span class="pre">pyvbmc.variational_posterior.variational_posterior.VariationalPosterior</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/lacerbi/pyvbmc/tree/main/pyvbmc\variational_posterior\variational_posterior.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.mtv" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the marginal total variation (MTV) distances between the VP and
another variational posterior.</p>
<p>The other variational posterior can be specified as <cite>vp2</cite> (an instance
of the class VariationalPosterior) or using with <cite>samples</cite> from the
other VariationalPosterior. One of the two must be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>vp2</strong><span class="classifier">VariationalPosterior, optional</span></dt><dd><p>The other VariationalPosterior, by default None.</p>
</dd>
<dt><strong>samples</strong><span class="classifier">np.ndarray, optional</span></dt><dd><p>An N-by-D matrix of samples from the other variational
posterior, by default None.</p>
</dd>
<dt><strong>N</strong><span class="classifier">int, optional</span></dt><dd><p>The number of random draws to estimate the MTV, by default int(1e5).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>mtv: np.ndarray</dt><dd><p>A D-element vector whose elements are the total variation distance
between the marginal distributions of VP and VP2 or samples,
for each coordinate dimension.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>Raised if neither vp2 nor samples are specified.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origflag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logflag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transflag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradflag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/lacerbi/pyvbmc/tree/main/pyvbmc\variational_posterior\variational_posterior.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the probability density function of VP approximation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">np.ndarray</span></dt><dd><p>X is a matrix of rows to evaluate the pdf at.
The Rows of the N-by-D matrix x
correspond to observations or points,
and columns correspond to variables or coordinates.</p>
</dd>
<dt><strong>origflag</strong><span class="classifier">bool, optional</span></dt><dd><p>Controls if the value of the posterior density should be evaluated
in the original parameter space for origflag=True (default), or
in the transformed space if origflag=False, by default True.</p>
</dd>
<dt><strong>logflag</strong><span class="classifier">bool, optional</span></dt><dd><p>Controls if the the log pdf should be returned if logflag=True,
this is by default False.</p>
</dd>
<dt><strong>transflag</strong><span class="classifier">bool, optional</span></dt><dd><p>Specifies if X is already specified in transformed space.
TRANSFLAG=True assumes that X is already specified in tranformed
space. Otherwise, X is specified in the original parameter
space, by default False.</p>
</dd>
<dt><strong>gradflag</strong><span class="classifier">bool, optional</span></dt><dd><p>If gradflag=True the gradient should be returned, by default False.</p>
</dd>
<dt><strong>df</strong><span class="classifier">float, optional</span></dt><dd><p>Compute the pdf of a heavy-tailed version of the
variational posterior, in which the multivariate normal components
have been replaced by  multivariate t-distributions with
DF degrees of freedom.The default is df=Inf, limit in which the
t-distribution becomes a multivariate normal., by default np.inf</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>pdf: np.ndarray</dt><dd><p>The probability density of the variational posterior
evaluated at each row of x.</p>
</dd>
<dt>gradient: np.ndarray</dt><dd><p>If the gradflag=True, the function returns
the gradient as well.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd><p>Raised if np.isfinite(df) and df &gt; 0 and gradflag=True
(Gradient of heavy-tailed pdf not supported yet).</p>
</dd>
<dt>NotImplementedError</dt><dd><p>Raised if np.isfinite(df) and df &lt; 0 and gradflag=True
(Gradient of heavy-tailed pdf not supported yet).</p>
</dd>
<dt>NotImplementedError</dt><dd><p>Raised if origflag=True and logflag=True and gradflag=True
(Gradient computation in original space not supported yet).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_vp_centres</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_style</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/lacerbi/pyvbmc/tree/main/pyvbmc\variational_posterior\variational_posterior.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the VP as a cornerplot of samples with optionally the centres of
the components and the datapoints of the GP. The plot can be enhanced
by custom styles and also datapoints of the GP can be highlighted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n_samples</strong><span class="classifier">int, optional</span></dt><dd><p>The number of samples from the , by default int(1e5)</p>
</dd>
<dt><strong>title</strong><span class="classifier">str, optional</span></dt><dd><p>The title of the plot, by default None</p>
</dd>
<dt><strong>plot_data</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to plot the datapoints of the GP, by default False</p>
</dd>
<dt><strong>highlight_data</strong><span class="classifier">list, optional</span></dt><dd><p>Indices of the datapoints that should be plotted in a different
way than the other datapoints, by default None</p>
</dd>
<dt><strong>plot_vp_centres</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to plot the centres of the VP components, by default False</p>
</dd>
<dt><strong>plot_style</strong><span class="classifier">dict, optional</span></dt><dd><dl class="simple">
<dt>A dictionary of plot styling options. The possible options are:</dt><dd><dl class="simple">
<dt><strong>corner</strong><span class="classifier">dict, optional</span></dt><dd><p>Styling options directly passed to the corner function.
By default: <cite>{“fig”: plt.figure(figsize=(8, 8)),
“labels”: labels}</cite>. See the documentation of <a class="reference external" href="https://corner.readthedocs.io/en/latest/index.html">corner</a>.</p>
</dd>
<dt><strong>data</strong><span class="classifier">dict, optional</span></dt><dd><p>Styling options used to plot the GP data.
By default: <cite>{“s”:15, “color”:’blue’, “facecolors”: “none”}</cite></p>
</dd>
<dt><strong>highlight_data</strong><span class="classifier">dict, optional</span></dt><dd><p>Styling options used to plot the highlighted GP data.
By default: <cite>{“s”:15, “color”:”orange”}</cite></p>
</dd>
<dt><strong>vp_centre</strong><span class="classifier">dict, optional</span></dt><dd><p>Styling options used to plot the VP centres.
By default: <cite>{“marker”:”x”, “color”:”red”}</cite></p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fig</strong><span class="classifier">matplotlib.figure.Figure</span></dt><dd><p>The resulting matplotlib figure of the plot.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origflag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">balanceflag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/lacerbi/pyvbmc/tree/main/pyvbmc\variational_posterior\variational_posterior.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample random samples from variational posterior-</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>N</strong><span class="classifier">int</span></dt><dd><p>The number of samples to be sampled.</p>
</dd>
<dt><strong>origflag</strong><span class="classifier">bool, optional</span></dt><dd><p>Controls if the the random vectors should be returned in the
original parameter space if origflag=True (default),
or in the transformed VBMC space
if origflag=False, by default True.</p>
</dd>
<dt><strong>balanceflag</strong><span class="classifier">bool, optional</span></dt><dd><p>The boolean balanceflag=True balances the generating process
such that the random samples in X come from each
mixture component exactly proportionally
(or as close as possible) to the variational mixture weights.
If balanceflag=False (default), the generating mixture
for each sample is determined randomly according to
the mixture weights, by default False.</p>
</dd>
<dt><strong>df</strong><span class="classifier">float, optional</span></dt><dd><p>Generate the samples from a heavy-tailed version
of the variational posterior, in which
the multivariate normal components have been replaced by
multivariate t-distributions with DF degrees of freedom.
The default is df=Inf, limit in which the t-distribution
becomes a multivariate normal, by default np.inf.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>X</strong><span class="classifier">np.ndarray</span></dt><dd><p>X is an N-by-D matrix of random vectors chosen
from the variational posterior.</p>
</dd>
<dt><strong>I</strong><span class="classifier">np.ndarray</span></dt><dd><p>I is an N-by-1 array such that the N-th
element of I indicates the index of the
variational mixture component from which
the N-th row of X has been generated.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyvbmc.variational_posterior.VariationalPosterior.set_parameters">
<span class="sig-name descname"><span class="pre">set_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawflag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/lacerbi/pyvbmc/tree/main/pyvbmc\variational_posterior\variational_posterior.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyvbmc.variational_posterior.VariationalPosterior.set_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes as input an np array and assigns it to the
variational posterior parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>theta</strong><span class="classifier">np.ndarray</span></dt><dd><p>The array with the parameters that should be assigned.</p>
</dd>
<dt><strong>rawflag</strong><span class="classifier">bool, optional</span></dt><dd><p>Specifies whether the sigma and lambda are
passed as raw (unconstrained) or not, by default True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>ValueError</dt><dd><p>Raised if sigma, lambda and weights are not positive
and rawflag = False</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../../quickstart.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Getting started</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="vbmc.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">VBMC</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
            &copy; Copyright 2021, Machine and Human Intelligence research group (PI: Luigi Acerbi, University of Helsinki).<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>